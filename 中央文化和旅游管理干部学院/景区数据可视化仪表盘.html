<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XX景区实时数据监测平台</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header h1 {
            font-size: 36px;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header .subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .header .update-time {
            font-size: 12px;
            margin-top: 10px;
            opacity: 0.8;
        }

        .live-badge {
            display: inline-block;
            background: #ff4444;
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            margin-left: 10px;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        /* 关键指标卡片 */
        .metrics {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s;
            position: relative;
            overflow: hidden;
        }

        .metric-card:hover {
            transform: translateY(-5px);
        }

        .metric-card.live::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #ff6b6b, #ee5a6f);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .metric-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .metric-value {
            font-size: 32px;
            font-weight: bold;
            color: #333;
            margin-bottom: 8px;
        }

        .metric-change {
            font-size: 12px;
            color: #27ae60;
        }

        .metric-change.down {
            color: #e74c3c;
        }

        .live-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #ff4444;
            border-radius: 50%;
            margin-left: 5px;
            animation: blink 1.5s infinite;
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        /* 图表区域 */
        .charts {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .chart-title {
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .chart-subtitle {
            font-size: 12px;
            color: #999;
            font-weight: normal;
        }

        .bottom-charts {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        canvas {
            max-height: 300px;
        }

        /* 响应式 */
        @media (max-width: 1200px) {
            .metrics {
                grid-template-columns: repeat(2, 1fr);
            }
            .charts {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .metrics {
                grid-template-columns: 1fr;
            }
            .bottom-charts {
                grid-template-columns: 1fr;
            }
        }

        /* 中国风装饰 */
        .decoration {
            position: fixed;
            opacity: 0.05;
            pointer-events: none;
        }

        .decoration.top-left {
            top: 0;
            left: 0;
            width: 200px;
            height: 200px;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path d="M50 10 Q70 30 50 50 Q30 30 50 10" fill="white"/></svg>');
        }
    </style>
</head>
<body>
    <div class="decoration top-left"></div>
    
    <div class="container">
        <!-- 头部 -->
        <div class="header">
            <h1>XX景区实时数据监测平台<span class="live-badge">● LIVE</span></h1>
            <div class="subtitle">Culture & Tourism Data Visualization Dashboard</div>
            <div class="update-time" id="updateTime">最后更新：2024-12-28 14:32:15</div>
        </div>

        <!-- 关键指标 -->
        <div class="metrics">
            <div class="metric-card live">
                <div class="metric-label">
                    今日累计游客量
                    <span class="live-indicator"></span>
                </div>
                <div class="metric-value" id="totalVisitors">15,234</div>
                <div class="metric-change">↑ 较昨日同期 +8.5%</div>
            </div>

            <div class="metric-card live">
                <div class="metric-label">
                    当前在园人数
                    <span class="live-indicator"></span>
                </div>
                <div class="metric-value" id="currentVisitors">3,421</div>
                <div class="metric-change" id="currentChange">↑ +23人/分钟</div>
            </div>

            <div class="metric-card live">
                <div class="metric-label">
                    今日累计收入
                    <span class="live-indicator"></span>
                </div>
                <div class="metric-value" id="totalRevenue">¥1,234,567</div>
                <div class="metric-change">↑ 较昨日同期 +12.3%</div>
            </div>

            <div class="metric-card">
                <div class="metric-label">
                    昨日游客满意度
                </div>
                <div class="metric-value" style="color: #f39c12;">4.8<span style="font-size: 18px;">/5.0</span></div>
                <div class="metric-change">↑ 较前日 +0.2</div>
            </div>
        </div>

        <!-- 主图表区 -->
        <div class="charts">
            <div class="chart-container">
                <div class="chart-title">
                    今日入园/出园趋势（按小时统计）
                    <span class="chart-subtitle">实时更新 <span class="live-indicator"></span></span>
                </div>
                <canvas id="trendChart"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    昨日游客来源分布
                    <span class="chart-subtitle">2024-12-27数据</span>
                </div>
                <canvas id="sourceChart"></canvas>
            </div>
        </div>

        <!-- 底部图表 -->
        <div class="bottom-charts">
            <div class="chart-container">
                <div class="chart-title">
                    本周热门景点TOP5
                    <span class="chart-subtitle">日均访问量</span>
                </div>
                <canvas id="hotspotChart"></canvas>
            </div>

            <div class="chart-container">
                <div class="chart-title">
                    本月门票预约方式
                    <span class="chart-subtitle">累计统计</span>
                </div>
                <canvas id="bookingChart"></canvas>
            </div>
        </div>
    </div>

    <script>
        // 全局变量
        let totalVisitorsCount = 15234;
        let currentVisitorsCount = 3421;
        let totalRevenueCount = 1234567;
        let trendChart, sourceChart, hotspotChart, bookingChart;
        
        // 今日入园/出园趋势数据（按小时统计，8:00开园）
        const trendData = {
            labels: ['08:00', '09:00', '10:00', '11:00', '12:00', '13:00', '14:00'],
            entryData: [1200, 1850, 1650, 1380, 980, 1520, 1680],  // 入园人数
            exitData: [0, 120, 380, 580, 920, 850, 1120]  // 出园人数
        };
        
        // 当前小时索引（14点）
        let currentHourIndex = 6;

        // 初始化图表
        function initCharts() {
            // 1. 入园/出园趋势图（实时更新）
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            trendChart = new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: trendData.labels,
                    datasets: [
                        {
                            label: '入园人数',
                            data: trendData.entryData,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            borderWidth: 2
                        },
                        {
                            label: '出园人数',
                            data: trendData.exitData,
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: false,
                            pointRadius: 4,
                            pointHoverRadius: 6,
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { 
                            display: true,
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return value.toLocaleString() + '人';
                                }
                            }
                        }
                    }
                }
            });

            // 2. 游客来源饼图（静态数据）
            const sourceCtx = document.getElementById('sourceChart').getContext('2d');
            sourceChart = new Chart(sourceCtx, {
                type: 'doughnut',
                data: {
                    labels: ['本地游客', '省内游客', '省外游客', '境外游客'],
                    datasets: [{
                        data: [40, 30, 22, 8],
                        backgroundColor: [
                            '#667eea',
                            '#764ba2',
                            '#f093fb',
                            '#4facfe'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });

            // 3. 热门景点柱状图（静态数据）
            const hotspotCtx = document.getElementById('hotspotChart').getContext('2d');
            hotspotChart = new Chart(hotspotCtx, {
                type: 'bar',
                data: {
                    labels: ['大雄宝殿', '千手观音', '竹林小径', '古戏台', '莲花池'],
                    datasets: [{
                        label: '日均访问量',
                        data: [8500, 7200, 6800, 5400, 4900],
                        backgroundColor: [
                            'rgba(102, 126, 234, 0.8)',
                            'rgba(118, 75, 162, 0.8)',
                            'rgba(240, 147, 251, 0.8)',
                            'rgba(79, 172, 254, 0.8)',
                            'rgba(255, 107, 107, 0.8)'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function(value) {
                                    return (value/1000).toFixed(1) + 'k';
                                }
                            }
                        }
                    }
                }
            });

            // 4. 预约方式饼图（静态数据）
            const bookingCtx = document.getElementById('bookingChart').getContext('2d');
            bookingChart = new Chart(bookingCtx, {
                type: 'pie',
                data: {
                    labels: ['微信小程序', '官网预约', '现场购票', '旅行社'],
                    datasets: [{
                        data: [45, 28, 18, 9],
                        backgroundColor: [
                            '#10b981',
                            '#3b82f6',
                            '#f59e0b',
                            '#ef4444'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        // 更新实时数据
        function updateRealTimeData() {
            const now = new Date();
            const timeStr = now.toLocaleString('zh-CN', {
                year: 'numeric',
                month: '2-digit',
                day: '2-digit',
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit',
                hour12: false
            });
            document.getElementById('updateTime').textContent = `最后更新：${timeStr}`;

            // 1. 今日累计游客量（只增不减，随机增加）
            const visitorIncrease = Math.floor(Math.random() * 15) + 5; // 5-20人
            totalVisitorsCount += visitorIncrease;
            animateNumber('totalVisitors', totalVisitorsCount);

            // 2. 当前在园人数（可增可减，但变化合理）
            const currentChange = Math.floor(Math.random() * 50) - 20; // -20 到 +30
            currentVisitorsCount = Math.max(2000, currentVisitorsCount + currentChange); // 最少2000人
            animateNumber('currentVisitors', currentVisitorsCount);
            
            const changeEl = document.getElementById('currentChange');
            if (currentChange > 0) {
                changeEl.textContent = `↑ +${Math.abs(currentChange)}人/分钟`;
                changeEl.className = 'metric-change';
            } else if (currentChange < 0) {
                changeEl.textContent = `↓ -${Math.abs(currentChange)}人/分钟`;
                changeEl.className = 'metric-change down';
            } else {
                changeEl.textContent = `→ 持平`;
                changeEl.className = 'metric-change';
            }

            // 3. 今日累计收入（只增不减）
            const revenueIncrease = Math.floor(Math.random() * 2000) + 500; // 500-2500元
            totalRevenueCount += revenueIncrease;
            animateNumber('totalRevenue', totalRevenueCount, true);

            // 4. 更新入园/出园趋势图（更新当前小时数据）
            const currentHour = now.getHours();
            
            // 只在工作时间更新（8:00-17:00）
            if (currentHour >= 8 && currentHour <= 17) {
                // 入园人数增长（早上和下午高峰多，中午和傍晚少）
                let entryIncrease;
                if (currentHour >= 9 && currentHour <= 10) {
                    entryIncrease = Math.floor(Math.random() * 50) + 30; // 早高峰：30-80人
                } else if (currentHour >= 13 && currentHour <= 14) {
                    entryIncrease = Math.floor(Math.random() * 40) + 25; // 午后高峰：25-65人
                } else if (currentHour >= 16) {
                    entryIncrease = Math.floor(Math.random() * 20) + 5; // 傍晚减少：5-25人
                } else {
                    entryIncrease = Math.floor(Math.random() * 30) + 15; // 正常时段：15-45人
                }
                
                // 出园人数增长（早上少，逐渐增多，傍晚最多）
                let exitIncrease;
                if (currentHour >= 8 && currentHour <= 10) {
                    exitIncrease = Math.floor(Math.random() * 10) + 2; // 早上很少：2-12人
                } else if (currentHour >= 11 && currentHour <= 13) {
                    exitIncrease = Math.floor(Math.random() * 25) + 15; // 中午增多：15-40人
                } else if (currentHour >= 16) {
                    exitIncrease = Math.floor(Math.random() * 60) + 40; // 傍晚最多：40-100人
                } else {
                    exitIncrease = Math.floor(Math.random() * 30) + 20; // 正常时段：20-50人
                }
                
                // 更新当前小时的数据
                trendData.entryData[currentHourIndex] += entryIncrease;
                trendData.exitData[currentHourIndex] += exitIncrease;
                
                // 更新图表
                trendChart.data.datasets[0].data = trendData.entryData;
                trendChart.data.datasets[1].data = trendData.exitData;
                trendChart.update('none'); // 无动画更新，更流畅
            }
        }

        // 数字滚动动画
        function animateNumber(elementId, targetValue, isCurrency = false) {
            const element = document.getElementById(elementId);
            const currentValue = parseInt(element.textContent.replace(/[^0-9]/g, ''));
            const step = Math.ceil((targetValue - currentValue) / 10);
            
            let current = currentValue;
            const timer = setInterval(() => {
                current += step;
                if (current >= targetValue) {
                    current = targetValue;
                    clearInterval(timer);
                }
                
                if (isCurrency) {
                    element.textContent = '¥' + current.toLocaleString();
                } else {
                    element.textContent = current.toLocaleString();
                }
            }, 50);
        }

        // 初始化
        window.onload = function() {
            initCharts();
            // 每5秒更新一次实时数据
            setInterval(updateRealTimeData, 5000);
        };
    </script>
</body>
</html>

